<app-navbar tipo="user"></app-navbar>

<div class="container mt-4">
  <h2 class="mb-4">Historial de Compras</h2>
  <div class="table-responsive">
    <table class="table table-hover align-middle">
      <thead class="table-primary">
        <tr>
          <th>#</th>
          <th>Fecha</th>
          <th>Total</th>
          <th>Estado</th>
          <th>Productos</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let compra of comprasPaginadas">
          <td>{{ compra.id }}</td>
          <td>{{ compra.fecha }}</td>
          <td>{{ formatearCLP(compra.total) }}</td>
          <td>
            <span class="badge"
              [ngClass]="{
                'bg-success': compra.estado === 'Entregado',
                'bg-warning text-dark': compra.estado === 'En camino',
                'bg-danger': compra.estado === 'Cancelado'
              }">
              {{ compra.estado }}
            </span>
          </td>
          <td>
            <ul class="mb-0 ps-3">
              <li *ngFor="let p of compra.productos">
                {{ p.nombre }} <span class="text-muted">x{{ p.cantidad }}</span>
              </li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Paginación -->
  <nav *ngIf="totalPaginas > 1" aria-label="Paginación de historial" class="mt-3">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="pagina === 1">
        <button class="page-link" (click)="paginaAnterior()" [disabled]="pagina === 1">Anterior</button>
      </li>
      <li class="page-item" *ngFor="let p of [].constructor(totalPaginas); let i = index" [class.active]="pagina === (i+1)">
        <button class="page-link" (click)="irAPagina(i+1)">{{ i+1 }}</button>
      </li>
      <li class="page-item" [class.disabled]="pagina === totalPaginas">
        <button class="page-link" (click)="paginaSiguiente()" [disabled]="pagina === totalPaginas">Siguiente</button>
      </li>
    </ul>
  </nav>
</div>
